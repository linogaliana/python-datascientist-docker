FROM inseefrlab/vscode-python

SHELL ["/bin/bash", "-c"]

USER root

# Make conda command available
ENV PATH="/miniconda/bin:${PATH}"

# Create the environment:
COPY environment.yml .

RUN conda install mamba -n base -c conda-forge && \
    mamba env create --force -q -n python-ENSAE --file environment.yml

RUN conda info --envs

# Make Python interpreter from "monenv" available
ENV PATH="/miniconda/envs/python-ENSAE/bin:${PATH}"

RUN python -m spacy download en_core_web_sm
RUN python -m gensim.downloader --download glove-wiki-gigaword-200

EXPOSE 5000
CMD ["pip", "freeze"]
